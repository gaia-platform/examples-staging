////////////////////////////////////////////////////
// Copyright (c) Gaia Platform LLC
//
// Use of this source code is governed by the MIT
// license that can be found in the LICENSE.txt file
// or at https://opensource.org/licenses/MIT.
////////////////////////////////////////////////////

#include "gaia/logger.hpp"
#include "gaia_pick_and_place.h"

ruleset pick_and_place_ruleset
{
    {
        if (@pick && !@place)
        {
            gaia_log::app().info("Trigger pick.");
            pick_action.insert();
        }
    }

    on_insert(pick_action)
    {
        gaia_log::app().info("Picking...");
        for (/state)
        {
            pick = false;
        }
        gaia_log::app().info("Pick completed. Trigger move.");
        move_action.insert();
    }

    on_insert(move_action)
    {
        gaia_log::app().info("Moving...");
        for (/state)
        {
            place = true;
        }
        gaia_log::app().info("Move complete.");
    }

    {
        if (!@pick && @place)
        {
            gaia_log::app().info("Ready for next pick.");
        }
    }
}
